# -------------------------------------------------------------------------
# Allow uploading images to collections
# Rule ID #920420 Request content type is not allowed by policy
# -------------------------------------------------------------------------
SecRule REQUEST_URI "@rx ^\/(?i)items\/.*\/images\/.*" \
    "id:130000,\
    phase:1,\
    ver:'jellyfin-rule-exclusions-plugin/1.0.0',\
    pass,\
    t:none,\
    nolog,\
    setvar:'tx.allowed_request_content_type=|image/jpeg|image/apng|image/gif|image/tiff|image/webp|image/png|'"

# allow removing something from favorites
# allow rule ID 911100 to include DELETE
SecRule REQUEST_URI "@rx ^/Users/.*/FavoriteItems/.*$" \
  "id:130001,\
  phase:1,\
  ver:'jellyfin-rule-exclusions-plugin/1.0.0',\
  pass,\
  nolog,\
  t:none,\
  setvar:'tx.allowed_methods=GET HEAD POST OPTIONS DELETE'"
