# -------------------------------------------------------------------------
# Prevent false positives for Remote Command Execution: Unix Command Injection
# (command without evasion) Rule ID #932235
# -------------------------------------------------------------------------
SecRule REQUEST_URI "@rx ^\/api\/v2.0\/registries.*" \
    "id:120001,\
    phase:1,\
    ver:'harbor-rule-exclusions-plugin/1.0.0',\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveById=932235"

# -------------------------------------------------------------------------
# Prevent false positives for Remote Command Execution: Direct Unix Command Execution
# Rule ID #932260
# -------------------------------------------------------------------------
SecRule REQUEST_URI "@rx ^\/api\/v2.0\/registries.*" \
    "id:120002,\
    phase:1,\
    ver:'harbor-rule-exclusions-plugin/1.0.0',\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveById=932260"

# -------------------------------------------------------------------------
# Allow users to manage repos in their projects
# Rule ID #911100
# -------------------------------------------------------------------------
SecRule REQUEST_URI "@rx ^\/api\/v2.0\/projects\/.*\/repositories\/.*" \
    "id:120003,\
    phase:1,\
    ver:'harbor-rule-exclusions-plugin/1.0.0',\
    pass,\
    t:none,\
    nolog,\
    setvar:'tx.allowed_methods=PUT POST GET HEAD OPTIONS DELETE'"


