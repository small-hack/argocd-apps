# -------------------------------------------------------------------------
# Prevent false positives for Server Side Request Forgery (SSRF) Attack
# Rule ID #934110
# -------------------------------------------------------------------------
SecRule REQUEST_URI "@rx ^\/login\/oauth\/authorize.*" \
    "id:140001,\
    phase:1,\
    ver:'forgejo-rule-exclusions-plugin/1.0.0',\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveById=934110"

# -------------------------------------------------------------------------
# Allow looking a a file named .config
# URL file extension is restricted by policy. Rule ID #920440
# Restricted File Access Attempt. RuleID #930130
# -------------------------------------------------------------------------
SecRule REQUEST_HEADERS:Host "@streq git.smallhack.org" \
    "id:140002,\
    phase:1,\
    ver:'forgejo-rule-exclusions-plugin/1.0.0',\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveById=920440,\
    ctl:ruleRemoveById=930130"
