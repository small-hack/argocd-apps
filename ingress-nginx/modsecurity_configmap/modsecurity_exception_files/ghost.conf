# -------------------------------------------------------------------------
# Prevent false positives for Remote Command Execution:
# Direct Unix Command Execution Event. Rule ID #932260
# -------------------------------------------------------------------------
SecRule REQUEST_URI "@rx ^\/api\/v2.0\/registries.*" \
    "id:150001,\
    phase:1,\
    ver:'ghost-rule-exclusions-plugin/1.0.0',\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveById=932260"

# -------------------------------------------------------------------------
# Allow users to delete invites Rule ID #911100
# -------------------------------------------------------------------------
SecRule REQUEST_URI "@rx ^\/ghost\/api\/admin\/invites\/.*" \
    "id:150002,\
    phase:1,\
    ver:'ghost-rule-exclusions-plugin/1.0.0',\
    pass,\
    t:none,\
    nolog,\
    setvar:'tx.allowed_methods=PUT POST GET HEAD OPTIONS DELETE'"

# -------------------------------------------------------------------------
# Allow users to see pages Rule ID #911100
# -------------------------------------------------------------------------
SecRule REQUEST_URI "@rx ^\/ghost\/api\/admin\/pages\/.*" \
    "id:150002,\
    phase:1,\
    ver:'ghost-rule-exclusions-plugin/1.0.0',\
    pass,\
    t:none,\
    nolog,\
    setvar:'tx.allowed_methods=PUT POST GET HEAD OPTIONS DELETE'"
