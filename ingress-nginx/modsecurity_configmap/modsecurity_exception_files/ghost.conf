# -------------------------------------------------------------------------
# Prevent false positives for Remote Command Execution:
# Direct Unix Command Execution Event. Rule ID #932260
# -------------------------------------------------------------------------
SecRule REQUEST_URI "@rx ^\/api\/v2.0\/registries.*" \
    "id:150001,\
    phase:1,\
    ver:'ghost-rule-exclusions-plugin/1.0.0',\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveById=932260"

# -------------------------------------------------------------------------
# Allow admins to delete invites Rule ID #911100
# -------------------------------------------------------------------------
SecRule REQUEST_URI "@rx ^\/ghost\/api\/admin\/invites\/.*" \
    "id:150002,\
    phase:1,\
    ver:'ghost-rule-exclusions-plugin/1.0.0',\
    pass,\
    t:none,\
    nolog,\
    setvar:'tx.allowed_methods=PUT POST GET HEAD PATCH DELETE'"

# -------------------------------------------------------------------------
# Allow admins to see pages Rule ID #911100
# -------------------------------------------------------------------------
SecRule REQUEST_URI "@rx ^\/ghost\/api\/admin\/pages\/.*" \
    "id:150003,\
    phase:1,\
    ver:'ghost-rule-exclusions-plugin/1.0.0',\
    pass,\
    t:none,\
    nolog,\
    setvar:'tx.allowed_methods=PUT POST GET HEAD PATCH DELETE'"

# -------------------------------------------------------------------------
# Allow admins to change settings Rule ID #911100
# -------------------------------------------------------------------------
SecRule REQUEST_URI "@rx ^\/ghost\/api\/admin\/users\/.*" \
    "id:150004,\
    phase:1,\
    ver:'ghost-rule-exclusions-plugin/1.0.0',\
    pass,\
    t:none,\
    nolog,\
    setvar:'tx.allowed_methods=PUT POST GET HEAD PATCH DELETE'"

# -------------------------------------------------------------------------
# Allow content types to inbox
# Rule ID #920420
# -------------------------------------------------------------------------
SecRule REQUEST_URI "@rx ^\/.ghost\/activitypub\/inbox\/.*" \
    "id:150005,\
    phase:1,\
    ver:'ghost-rule-exclusions-plugin/1.0.0',\
    pass,\
    t:none,\
    nolog,\
    setvar:'tx.allowed_request_content_type=|application/activity+json|application/ld+json|text/html'"

# -------------------------------------------------------------------------
# Allow admins to post settings Rule ID #911100
# -------------------------------------------------------------------------
SecRule REQUEST_URI "@rx ^\/ghost\/api\/admin\/posts\/.*" \
    "id:150006,\
    phase:1,\
    ver:'ghost-rule-exclusions-plugin/1.0.0',\
    pass,\
    t:none,\
    nolog,\
    setvar:'tx.allowed_methods=PUT POST GET HEAD PATCH DELETE'"
