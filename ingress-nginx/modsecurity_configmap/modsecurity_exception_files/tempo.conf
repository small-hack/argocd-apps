# Prevents blocking remote-writes for parquet
SecRule REQUEST_URI "@beginsWith /tempo/single-tenant" \
  "id:100000,\
  phase:1,\
  ver:'tempo-exclusions-plugin/1.0.0',\
  pass,\
  nolog,\
  t:none,\
  setvar:'tx.allowed_methods=PUT POST GET HEAD OPTIONS DELETE'"

# allow "Request Containing Content, but Missing Content-Type header"  rule 920340
# rule 920340
SecRule REQUEST_URI "@beginsWith /tempo/single-tenant" \
  "id:100001,\
  phase:1,\
  ver:'tempo-exclusions-plugin/1.0.0',\
  pass,\
  nolog,\
  t:none,\
  ctl:ruleRemoveById=920340"

# Exception for Request content type is not allowed by policy. Rule 920420
SecRule REQUEST_URI "@beginsWith /tempo/single-tenant" \
  "id:100002,\
  phase:1,\
  ver:'tempo-exclusions-plugin/1.0.0',\
  pass,\
  nolog,\
  t:none,\
  setvar:'tx.allowed_request_content_type=|application/octet-stream|'"
