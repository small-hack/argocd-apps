# Enable grpc parsing for zitadle only, avoids hitting ruleID 920420"
SecRule REQUEST_URI "@beginsWith /zitadel.auth.v1.AuthService" \
    "id:60001,\
    phase:1,\
    ver:'zitadel-rule-exclusions-plugin/1.0.0',\
    pass,\
    t:none,\
    nolog,\
    setvar:'tx.allowed_request_content_type=|application/grpc-web+proto|'"

SecRule REQUEST_URI "@beginsWith /zitadel.admin.v1.AdminService" \
    "id:60002,\
    phase:1,\
    ver:'zitadel-rule-exclusions-plugin/1.0.0',\
    pass,\
    t:none,\
    nolog,\
    setvar:'tx.allowed_request_content_type=|application/grpc-web+proto|'"

SecRule REQUEST_URI "@beginsWith /zitadel.management.v1.ManagementService" \
    "id:60003,\
    ver:'zitadel-rule-exclusions-plugin/1.0.0',\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    setvar:'tx.allowed_request_content_type=|application/grpc-web+proto|'"

# zitadel sends a __Host-zitadel.useragent cookie that sometimes has a = in it
SecRuleUpdateTargetById 941120 "!REQUEST_COOKIES:__Host-zitadel.useragent"
