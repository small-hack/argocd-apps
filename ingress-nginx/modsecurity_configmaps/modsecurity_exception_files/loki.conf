# allow "Request Containing Content, but Missing Content-Type header"  rule 920340
# rule 920340
# Dont treat loki writes as an http smuggeling attack
# Rule 921110
# Remote Command Execution: Java process spawn (CVE-2017-9805)
# 944110
# Allow PUT method to /loki/<org name>/ rule 921110
# this is for when loki tries to flush chunks
# Suspicious Java class detected Event 944130
SecRule REQUEST_URI "@beginsWith /loki" \
  "id:550001,\
  phase:1,\
  ver:'loki-exclusions-plugin/1.0.0',\
  pass,\
  nolog,\
  t:none,\
  ctl:ruleRemoveById=911100,\
  ctl:ruleRemoveById=920340,\
  ctl:ruleRemoveById=921110,\
  ctl:ruleRemoveById=944100,\
  ctl:ruleRemoveById=944110,\
  ctl:ruleRemoveById=944130"
